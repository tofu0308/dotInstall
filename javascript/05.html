<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>文字数チェッカー</title>


<style>
#memo {
	width: 480px;
	height: 160px;
}

.warning{
	color:#ff0000;
	font-weight: bold;
}

</style>

</head>
<body>
	<h1>文字数チェッカー</h1>
	<textarea id="memo"></textarea>
	<div id="count"></div>


<script src="//code.jquery.com/jquery-1.12.0.min.js"></script>
<script>
	(function(){
		/*
		//最大文字数
		var LIMIT = 30;

		//警告開始文字数
		var WARNING = 10;

		// memo,count関数化
		var memo = document.getElementById('memo');
		var count = document.getElementById('count');

		//countに現在の文字数（初期数値）を格納
		count.innerHTML = LIMIT;

		function countChars(textarea){
			//残り文字数を計算
			var remaining = LIMIT - textarea.value.length;
			count.innerHTML = remaining;
			
			//remaining（残り文字数がWARNING(10)以下かどうか）
			if(remaining <= WARNING){
				count.className = 'warning';
			}else{
				count.className = '';
			}
		}

		if(memo.attachEvent){
			//　＞　IE8
			memo.attachEvent('onkeyup' , function(e){
				countChars(e.srcElement);
			});
		}else{
			//その他のブラウザ
			//イベント追加
			memo.addEventListener('keyup' , function(){
				countChars(this);
			});
		}
		*/

		//ｊQueryに書き換え
		var LIMIT = 30;
		var WARNING = 10;
		var count = $('#count')

		count.text(LIMIT);

		//0未満にしたくないのでmaxlengthを挿入
		$('textarea#memo').attr('maxlength', LIMIT);


		function countChars(textarea){
			var remaining = LIMIT - textarea.val().length;
			
			//remainingが0未満になるとき0を代入
			if(remaining < 0){
				var remaining = 0;
			}

			count.text(remaining);
			
			if(remaining <= WARNING){
				count.addClass('warning');
			}else{
				count.removeClass('warning');
			}
		}

		$('#memo').keyup(function(){
			countChars($(this));
		});
	})();




	



</script>

</body>
</html>